

  - name: Make mount point for NFS
    file: 
      state: directory
      path: /mnt/nfsexport01
      mode: '0755'
    become: yes

  - name: Mount nfsexport
    mount:
      state: mounted
      path: /mnt/nfsexport01
      fstype: nfs
      src: 'nfsexport01.ti.com:/ocp_root/'
    become: true

  - name: Create cluster dir
    file:
      state: directory
      path: "mnt/nfsexport01/{{ ocp_cluster_name }}"
      mode: "0777"
    become: true

  - name: Loop Over 
  
  - name: Unmount nfsexport
    mount:
      state: unmounted
      path: /mnt/nfsexport01
    become: true


# - name: Get persistent_volumes
#   k8s_info:
#     kind: PersistentVolume
#   register: persistent_volumes


# - name: Dump var to file
#   debug:
#     msg: "{{ item.metadata.name }} - {%if item.spec.claimRef is defined %}{{ item.status.phase }}{% else %}Available{% endif %}"
#   loop: "{{ persistent_volumes.resources }}"
#   loop_control:
#     extended: yes
#     label: "{{ item.metadata.name }}"






  # - name: Dump var to file
  #   debug:
  #     msg: "{% for pv in persistent_volumes.resources %} \
  #             {% if pv.status is defined %} \
  #               {% if pv.status.phase == 'Failed' %} \
  #                  {{ pv.metadata.name }} - {{ pv.status.phase }}\n \
  #               {% endif %} \
  #             {% endif %} \
  #           {% endfor %} "
 



